# ã„ã„ã­æ©Ÿèƒ½ UIè¨­è¨ˆæ›¸ï¼ˆæ—¢å­˜ã‚«ãƒ¼ãƒ‰ãƒ‡ã‚¶ã‚¤ãƒ³å¯¾å¿œï¼‰

## 1. æ—¢å­˜ã‚«ãƒ¼ãƒ‰ãƒ‡ã‚¶ã‚¤ãƒ³ã®ç¶­æŒ

ç¾åœ¨ã®è»Šæ—…ã‚³ãƒ³ã‚·ã‚§ãƒ«ã‚¸ãƒ¥ã§ã¯ã€ä»¥ä¸‹ã®ã‚«ãƒ¼ãƒ‰ãƒ‡ã‚¶ã‚¤ãƒ³ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ï¼š
- ã‚ªãƒ¬ãƒ³ã‚¸ã®å·¦å´ã‚¹ãƒˆãƒ©ã‚¤ãƒ—
- ãƒ™ãƒ¼ã‚¸ãƒ¥/ã‚¯ãƒªãƒ¼ãƒ è‰²ã®èƒŒæ™¯
- ç•ªå·ä»˜ãã‚«ãƒ¼ãƒ‰
- åœ°å›³ãƒ»æ¤œç´¢ãƒœã‚¿ãƒ³

**ã“ã®ãƒ‡ã‚¶ã‚¤ãƒ³ã‚’ç¶­æŒã—ã¤ã¤ã€ã„ã„ã­ãƒœã‚¿ãƒ³ã¨ã„ã„ã­æ•°ã®ã¿ã‚’è¿½åŠ ã—ã¾ã™ã€‚**

---

## 2. ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã‚«ãƒ¼ãƒ‰ã®ã„ã„ã­æ©Ÿèƒ½è¿½åŠ 

### 2.1 ç¾åœ¨ã®ãƒ‡ã‚¶ã‚¤ãƒ³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1                                     â”‚
â”‚                                       â”‚
â”‚ é†¤æ²¹ã¨è²ã¨éºº ãã—ã¦äººã¨å¤¢            â”‚
â”‚                                       â”‚
â”‚ [ãƒ©ãƒ¼ãƒ¡ãƒ³]                            â”‚
â”‚                                       â”‚
â”‚ ğŸ“ å¤§é˜ªåºœå¤§é˜ªå¸‚è¥¿æ·€å·åŒºæŸé‡Œ3-12-22    â”‚
â”‚                                       â”‚
â”‚ [ğŸ—ºï¸ åœ°å›³] [ğŸ” æ¤œç´¢]                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ã„ã„ã­è¿½åŠ å¾Œã®ãƒ‡ã‚¶ã‚¤ãƒ³ï¼ˆæ¡ˆA: å³ä¸Šé…ç½®ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1                        â¤ï¸ 24        â”‚
â”‚                                       â”‚
â”‚ é†¤æ²¹ã¨è²ã¨éºº ãã—ã¦äººã¨å¤¢            â”‚
â”‚                                       â”‚
â”‚ [ãƒ©ãƒ¼ãƒ¡ãƒ³]                            â”‚
â”‚                                       â”‚
â”‚ ğŸ“ å¤§é˜ªåºœå¤§é˜ªå¸‚è¥¿æ·€å·åŒºæŸé‡Œ3-12-22    â”‚
â”‚                                       â”‚
â”‚ [ğŸ—ºï¸ åœ°å›³] [ğŸ” æ¤œç´¢]                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é…ç½®ä½ç½®:** ã‚«ãƒ¼ãƒ‰å³ä¸Šï¼ˆç•ªå·ã®åå¯¾å´ï¼‰
**ãƒ¡ãƒªãƒƒãƒˆ:** è¦–èªæ€§ãŒé«˜ãã€æ—¢å­˜ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’å´©ã•ãªã„

### 2.3 ã„ã„ã­è¿½åŠ å¾Œã®ãƒ‡ã‚¶ã‚¤ãƒ³ï¼ˆæ¡ˆB: ãƒœã‚¿ãƒ³è¡Œé…ç½®ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1                                     â”‚
â”‚                                       â”‚
â”‚ é†¤æ²¹ã¨è²ã¨éºº ãã—ã¦äººã¨å¤¢            â”‚
â”‚                                       â”‚
â”‚ [ãƒ©ãƒ¼ãƒ¡ãƒ³]                            â”‚
â”‚                                       â”‚
â”‚ ğŸ“ å¤§é˜ªåºœå¤§é˜ªå¸‚è¥¿æ·€å·åŒºæŸé‡Œ3-12-22    â”‚
â”‚                                       â”‚
â”‚ [ğŸ—ºï¸ åœ°å›³] [ğŸ” æ¤œç´¢] [â¤ï¸ 24]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é…ç½®ä½ç½®:** åœ°å›³ãƒ»æ¤œç´¢ãƒœã‚¿ãƒ³ã®æ¨ª
**ãƒ¡ãƒªãƒƒãƒˆ:** ãƒœã‚¿ãƒ³ç¾¤ã¨ã—ã¦ã¾ã¨ã¾ã‚‹

---

## 3. HTMLå®Ÿè£…ï¼ˆæ¡ˆA: å³ä¸Šé…ç½® - æ¨å¥¨ï¼‰

### 3.1 ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã‚«ãƒ¼ãƒ‰

```html
<div class="restaurant-card" data-restaurant-id="uuid-123">
  <!-- å·¦å´ã®ã‚ªãƒ¬ãƒ³ã‚¸ã‚¹ãƒˆãƒ©ã‚¤ãƒ— -->
  <div class="card-stripe"></div>

  <!-- ã‚«ãƒ¼ãƒ‰å†…å®¹ -->
  <div class="card-content">
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œï¼ˆç•ªå· + ã„ã„ã­ãƒœã‚¿ãƒ³ï¼‰ -->
    <div class="card-header">
      <span class="card-number">1</span>
      <button class="like-btn" onclick="toggleRestaurantLike('uuid-123')" aria-label="ã„ã„ã­">
        <svg class="heart-icon" viewBox="0 0 24 24" width="20" height="20">
          <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
        </svg>
        <span class="like-count">24</span>
      </button>
    </div>

    <!-- ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³å -->
    <h3 class="restaurant-name">é†¤æ²¹ã¨è²ã¨éºº ãã—ã¦äººã¨å¤¢</h3>

    <!-- ã‚¸ãƒ£ãƒ³ãƒ« -->
    <div class="restaurant-genre">
      <span class="genre-tag">ãƒ©ãƒ¼ãƒ¡ãƒ³</span>
    </div>

    <!-- ä½æ‰€ -->
    <p class="restaurant-address">
      ğŸ“ å¤§é˜ªåºœå¤§é˜ªå¸‚è¥¿æ·€å·åŒºæŸé‡Œ3-12-22
    </p>

    <!-- ãƒœã‚¿ãƒ³ç¾¤ -->
    <div class="card-actions">
      <a href="#" class="btn-map" onclick="openMap(event, lat, lng)">
        ğŸ—ºï¸ åœ°å›³
      </a>
      <a href="#" class="btn-search" target="_blank">
        ğŸ” æ¤œç´¢
      </a>
    </div>
  </div>
</div>
```

### 3.2 é§è»Šå ´ã‚«ãƒ¼ãƒ‰

```html
<div class="parking-card" data-parking-id="uuid-456">
  <!-- å·¦å´ã®ã‚ªãƒ¬ãƒ³ã‚¸ã‚¹ãƒˆãƒ©ã‚¤ãƒ— -->
  <div class="card-stripe"></div>

  <!-- ã‚«ãƒ¼ãƒ‰å†…å®¹ -->
  <div class="card-content">
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œï¼ˆç•ªå· + ã„ã„ã­ãƒœã‚¿ãƒ³ï¼‰ -->
    <div class="card-header">
      <span class="card-number">1</span>
      <button class="like-btn" onclick="toggleParkingLike('uuid-456')" aria-label="ã„ã„ã­">
        <svg class="heart-icon" viewBox="0 0 24 24" width="20" height="20">
          <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
        </svg>
        <span class="like-count">12</span>
      </button>
    </div>

    <!-- é§è»Šå ´å -->
    <h3 class="parking-name">ã‚¿ã‚¤ãƒ ã‚ºéŠ€åº§</h3>

    <!-- æ–™é‡‘æƒ…å ± -->
    <div class="parking-fee">
      <span class="fee-label">è»Šä¸­æ³Šæ–™é‡‘ï¼ˆæ¦‚ç®—ï¼‰</span>
      <span class="fee-value">Â¥1,500</span>
    </div>

    <!-- ä½æ‰€ -->
    <p class="parking-address">
      ğŸ“ æ±äº¬éƒ½ä¸­å¤®åŒºéŠ€åº§4-1-1
    </p>

    <!-- å–¶æ¥­æ™‚é–“ -->
    <p class="parking-hours">
      ğŸ•’ 24æ™‚é–“å–¶æ¥­
    </p>

    <!-- ãƒœã‚¿ãƒ³ç¾¤ -->
    <div class="card-actions">
      <a href="#" class="btn-map" onclick="openMap(event, lat, lng)">
        ğŸ—ºï¸ åœ°å›³
      </a>
      <a href="#" class="btn-details">
        ğŸ“‹ è©³ç´°
      </a>
    </div>
  </div>
</div>
```

---

## 4. CSSå®Ÿè£…

### 4.1 æ—¢å­˜ã‚¹ã‚¿ã‚¤ãƒ«ã®ç¶­æŒ

```css
/* ã‚«ãƒ¼ãƒ‰åŸºæœ¬ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆæ—¢å­˜ï¼‰ */
.restaurant-card,
.parking-card {
  position: relative;
  background: #FFF8DC; /* ãƒ™ãƒ¼ã‚¸ãƒ¥/ã‚¯ãƒªãƒ¼ãƒ è‰² */
  border-radius: 8px;
  margin-bottom: 20px;
  padding: 20px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  overflow: hidden;
}

/* å·¦å´ã®ã‚ªãƒ¬ãƒ³ã‚¸ã‚¹ãƒˆãƒ©ã‚¤ãƒ—ï¼ˆæ—¢å­˜ï¼‰ */
.card-stripe {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 6px;
  background: #FF8C00; /* ã‚ªãƒ¬ãƒ³ã‚¸ */
}

/* ã‚«ãƒ¼ãƒ‰å†…å®¹ã‚¨ãƒªã‚¢ */
.card-content {
  margin-left: 10px; /* ã‚¹ãƒˆãƒ©ã‚¤ãƒ—åˆ†ã®ä½™ç™½ */
}
```

### 4.2 ã„ã„ã­ãƒœã‚¿ãƒ³ã®è¿½åŠ ã‚¹ã‚¿ã‚¤ãƒ«

```css
/* ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œï¼ˆç•ªå· + ã„ã„ã­ãƒœã‚¿ãƒ³ï¼‰ */
.card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
}

/* ã‚«ãƒ¼ãƒ‰ç•ªå·ï¼ˆæ—¢å­˜ï¼‰ */
.card-number {
  font-size: 2em;
  font-weight: bold;
  color: #FF8C00;
  line-height: 1;
}

/* ã„ã„ã­ãƒœã‚¿ãƒ³ */
.like-btn {
  display: flex;
  align-items: center;
  gap: 4px;
  background: none;
  border: none;
  cursor: pointer;
  padding: 6px 10px;
  border-radius: 20px;
  transition: all 0.2s;
}

.like-btn:hover {
  background: rgba(255, 140, 0, 0.1);
  transform: scale(1.05);
}

.like-btn:active {
  transform: scale(0.95);
}

/* ãƒãƒ¼ãƒˆã‚¢ã‚¤ã‚³ãƒ³ */
.heart-icon {
  fill: #ccc;
  transition: fill 0.3s;
}

.heart-icon.liked {
  fill: #e74c3c;
  animation: heartbeat 0.4s ease-in-out;
}

@keyframes heartbeat {
  0%, 100% {
    transform: scale(1);
  }
  25% {
    transform: scale(1.2);
  }
  50% {
    transform: scale(1.1);
  }
  75% {
    transform: scale(1.15);
  }
}

/* ã„ã„ã­æ•° */
.like-count {
  font-size: 14px;
  color: #666;
  font-weight: 600;
  min-width: 20px;
  text-align: left;
}

/* ã„ã„ã­æ¸ˆã¿æ™‚ã®æ•°å­—ã®è‰² */
.like-btn .heart-icon.liked ~ .like-count {
  color: #e74c3c;
}
```

### 4.3 ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³åãƒ»é§è»Šå ´åï¼ˆæ—¢å­˜ã‚¹ã‚¿ã‚¤ãƒ«ç¶­æŒï¼‰

```css
.restaurant-name,
.parking-name {
  font-size: 1.3em;
  font-weight: bold;
  color: #333;
  margin: 0 0 12px 0;
  line-height: 1.4;
}

.restaurant-genre {
  margin-bottom: 12px;
}

.genre-tag {
  display: inline-block;
  background: #FF8C00;
  color: white;
  padding: 6px 16px;
  border-radius: 20px;
  font-size: 0.9em;
  font-weight: 500;
}

.restaurant-address,
.parking-address {
  font-size: 0.95em;
  color: #666;
  margin: 8px 0;
  line-height: 1.5;
}

.parking-fee {
  background: rgba(255, 140, 0, 0.1);
  padding: 12px;
  border-radius: 6px;
  margin: 12px 0;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.fee-label {
  font-size: 0.9em;
  color: #666;
}

.fee-value {
  font-size: 1.4em;
  font-weight: bold;
  color: #FF8C00;
}
```

### 4.4 ãƒœã‚¿ãƒ³ç¾¤ï¼ˆæ—¢å­˜ã‚¹ã‚¿ã‚¤ãƒ«ç¶­æŒï¼‰

```css
.card-actions {
  display: flex;
  gap: 10px;
  margin-top: 16px;
}

.btn-map,
.btn-search,
.btn-details {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 8px 16px;
  background: #4285f4;
  color: white;
  text-decoration: none;
  border-radius: 6px;
  font-size: 0.9em;
  font-weight: 500;
  transition: background 0.2s;
}

.btn-map:hover,
.btn-search:hover,
.btn-details:hover {
  background: #3367d6;
}

.btn-search {
  background: #34a853;
}

.btn-search:hover {
  background: #2d8e47;
}

.btn-details {
  background: #fbbc04;
  color: #333;
}

.btn-details:hover {
  background: #f9ab00;
}
```

---

## 5. JavaScriptå®Ÿè£…

### 5.1 ã„ã„ã­æ©Ÿèƒ½

```javascript
// likes.js

// ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒ—ãƒªãƒ³ãƒˆ
let userFingerprint = null;

// ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒ—ãƒªãƒ³ãƒˆåˆæœŸåŒ–
async function initFingerprint() {
  const fp = await FingerprintJS.load();
  const result = await fp.get();
  userFingerprint = result.visitorId;
}

// ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã¸ã®ã„ã„ã­åˆ‡ã‚Šæ›¿ãˆ
async function toggleRestaurantLike(restaurantId) {
  const card = document.querySelector(`[data-restaurant-id="${restaurantId}"]`);
  const likeBtn = card.querySelector('.like-btn');
  const heartIcon = likeBtn.querySelector('.heart-icon');
  const likeCount = likeBtn.querySelector('.like-count');
  const isLiked = heartIcon.classList.contains('liked');

  try {
    if (isLiked) {
      // ã„ã„ã­å‰Šé™¤
      await supabase
        .from('likes')
        .delete()
        .eq('target_type', 'restaurant')
        .eq('target_id', restaurantId)
        .eq(currentUser ? 'user_id' : 'user_fingerprint',
            currentUser ? currentUser.id : userFingerprint);

      heartIcon.classList.remove('liked');
    } else {
      // ã„ã„ã­è¿½åŠ 
      await supabase
        .from('likes')
        .insert({
          target_type: 'restaurant',
          target_id: restaurantId,
          user_id: currentUser?.id || null,
          user_fingerprint: currentUser ? null : userFingerprint
        });

      heartIcon.classList.add('liked');
    }

    // ã„ã„ã­æ•°ã‚’å†å–å¾—
    const { data: count } = await supabase
      .rpc('get_likes_count', {
        target_type_param: 'restaurant',
        target_id_param: restaurantId
      });

    likeCount.textContent = count || 0;

  } catch (error) {
    console.error('ã„ã„ã­ã‚¨ãƒ©ãƒ¼:', error);
    alert('ã„ã„ã­ã«å¤±æ•—ã—ã¾ã—ãŸ');
  }
}

// é§è»Šå ´ã¸ã®ã„ã„ã­åˆ‡ã‚Šæ›¿ãˆ
async function toggleParkingLike(parkingId) {
  const card = document.querySelector(`[data-parking-id="${parkingId}"]`);
  const likeBtn = card.querySelector('.like-btn');
  const heartIcon = likeBtn.querySelector('.heart-icon');
  const likeCount = likeBtn.querySelector('.like-count');
  const isLiked = heartIcon.classList.contains('liked');

  try {
    if (isLiked) {
      // ã„ã„ã­å‰Šé™¤
      await supabase
        .from('likes')
        .delete()
        .eq('target_type', 'parking_spot')
        .eq('target_id', parkingId)
        .eq(currentUser ? 'user_id' : 'user_fingerprint',
            currentUser ? currentUser.id : userFingerprint);

      heartIcon.classList.remove('liked');
    } else {
      // ã„ã„ã­è¿½åŠ 
      await supabase
        .from('likes')
        .insert({
          target_type: 'parking_spot',
          target_id: parkingId,
          user_id: currentUser?.id || null,
          user_fingerprint: currentUser ? null : userFingerprint
        });

      heartIcon.classList.add('liked');
    }

    // ã„ã„ã­æ•°ã‚’å†å–å¾—
    const { data: count } = await supabase
      .rpc('get_likes_count', {
        target_type_param: 'parking_spot',
        target_id_param: parkingId
      });

    likeCount.textContent = count || 0;

  } catch (error) {
    console.error('ã„ã„ã­ã‚¨ãƒ©ãƒ¼:', error);
    alert('ã„ã„ã­ã«å¤±æ•—ã—ã¾ã—ãŸ');
  }
}

// ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åˆæœŸåŒ–
document.addEventListener('DOMContentLoaded', async () => {
  await initFingerprint();
  await loadLikeStates();
});

// ã„ã„ã­çŠ¶æ…‹ã‚’èª­ã¿è¾¼ã¿
async function loadLikeStates() {
  const regionSlug = getRegionSlug();

  // ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã®ã„ã„ã­çŠ¶æ…‹ã‚’èª­ã¿è¾¼ã¿
  const restaurantCards = document.querySelectorAll('.restaurant-card');
  for (const card of restaurantCards) {
    const restaurantId = card.dataset.restaurantId;

    // ã„ã„ã­æ•°ã‚’å–å¾—
    const { data: count } = await supabase
      .rpc('get_likes_count', {
        target_type_param: 'restaurant',
        target_id_param: restaurantId
      });

    card.querySelector('.like-count').textContent = count || 0;

    // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ—¢ã«ã„ã„ã­æ¸ˆã¿ã‹ãƒã‚§ãƒƒã‚¯
    const { data: liked } = await supabase
      .rpc('check_user_liked', {
        target_type_param: 'restaurant',
        target_id_param: restaurantId,
        user_id_param: currentUser?.id || null,
        fingerprint_param: userFingerprint
      });

    if (liked) {
      card.querySelector('.heart-icon').classList.add('liked');
    }
  }

  // é§è»Šå ´ã®ã„ã„ã­çŠ¶æ…‹ã‚‚åŒæ§˜ã«èª­ã¿è¾¼ã¿
  const parkingCards = document.querySelectorAll('.parking-card');
  for (const card of parkingCards) {
    const parkingId = card.dataset.parkingId;

    const { data: count } = await supabase
      .rpc('get_likes_count', {
        target_type_param: 'parking_spot',
        target_id_param: parkingId
      });

    card.querySelector('.like-count').textContent = count || 0;

    const { data: liked } = await supabase
      .rpc('check_user_liked', {
        target_type_param: 'parking_spot',
        target_id_param: parkingId,
        user_id_param: currentUser?.id || null,
        fingerprint_param: userFingerprint
      });

    if (liked) {
      card.querySelector('.heart-icon').classList.add('liked');
    }
  }
}

// URLã‹ã‚‰åœ°åŸŸã‚¹ãƒ©ãƒƒã‚°ã‚’å–å¾—
function getRegionSlug() {
  const path = window.location.pathname;
  const fileName = path.split('/').pop().replace('.html', '');
  return fileName;
}
```

---

## 6. ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³

### 6.1 ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ

```css
/* ãƒ¢ãƒã‚¤ãƒ«ï¼ˆ768pxä»¥ä¸‹ï¼‰ */
@media (max-width: 768px) {
  .restaurant-card,
  .parking-card {
    padding: 16px;
  }

  .card-number {
    font-size: 1.5em;
  }

  .restaurant-name,
  .parking-name {
    font-size: 1.1em;
  }

  .like-btn {
    padding: 4px 8px;
  }

  .heart-icon {
    width: 18px;
    height: 18px;
  }

  .like-count {
    font-size: 13px;
  }

  .card-actions {
    flex-direction: column;
  }

  .btn-map,
  .btn-search,
  .btn-details {
    width: 100%;
    justify-content: center;
  }
}
```

---

## 7. æ—¢å­˜HTMLãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®çµ±åˆæ–¹æ³•

### 7.1 generate-from-json-sources.js ã®ä¿®æ­£

æ—¢å­˜ã®HTMLç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã€ã„ã„ã­ãƒœã‚¿ãƒ³ã‚’è¿½åŠ ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æŒ¿å…¥ã—ã¾ã™ã€‚

```javascript
// ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã‚«ãƒ¼ãƒ‰ç”Ÿæˆéƒ¨åˆ†ã‚’ä¿®æ­£

function generateRestaurantCard(restaurant, index) {
  return `
    <div class="restaurant-card" data-restaurant-id="${restaurant.id}">
      <div class="card-stripe"></div>
      <div class="card-content">
        <div class="card-header">
          <span class="card-number">${index + 1}</span>
          <button class="like-btn" onclick="toggleRestaurantLike('${restaurant.id}')" aria-label="ã„ã„ã­">
            <svg class="heart-icon" viewBox="0 0 24 24" width="20" height="20">
              <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
            </svg>
            <span class="like-count">0</span>
          </button>
        </div>

        <h3 class="restaurant-name">${escapeHtml(restaurant.name)}</h3>

        <div class="restaurant-genre">
          <span class="genre-tag">${escapeHtml(restaurant.genre)}</span>
        </div>

        <p class="restaurant-address">
          ğŸ“ ${escapeHtml(restaurant.address)}
        </p>

        <div class="card-actions">
          <a href="#" class="btn-map" onclick="openMap(event, ${restaurant.latitude}, ${restaurant.longitude})">
            ğŸ—ºï¸ åœ°å›³
          </a>
          <a href="https://www.google.com/search?q=${encodeURIComponent(restaurant.name)}"
             class="btn-search" target="_blank">
            ğŸ” æ¤œç´¢
          </a>
        </div>
      </div>
    </div>
  `;
}

// é§è»Šå ´ã‚«ãƒ¼ãƒ‰ç”Ÿæˆéƒ¨åˆ†ã‚‚åŒæ§˜ã«ä¿®æ­£
function generateParkingCard(parking, index) {
  return `
    <div class="parking-card" data-parking-id="${parking.id}">
      <div class="card-stripe"></div>
      <div class="card-content">
        <div class="card-header">
          <span class="card-number">${index + 1}</span>
          <button class="like-btn" onclick="toggleParkingLike('${parking.id}')" aria-label="ã„ã„ã­">
            <svg class="heart-icon" viewBox="0 0 24 24" width="20" height="20">
              <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
            </svg>
            <span class="like-count">0</span>
          </button>
        </div>

        <h3 class="parking-name">${escapeHtml(parking.name)}</h3>

        <div class="parking-fee">
          <span class="fee-label">è»Šä¸­æ³Šæ–™é‡‘ï¼ˆæ¦‚ç®—ï¼‰</span>
          <span class="fee-value">Â¥${parking.overnight_fee?.toLocaleString() || '---'}</span>
        </div>

        <p class="parking-address">
          ğŸ“ ${escapeHtml(parking.address || 'ä½æ‰€æƒ…å ±ãªã—')}
        </p>

        <p class="parking-hours">
          ğŸ•’ ${parking.business_hours || '24æ™‚é–“å–¶æ¥­'}
        </p>

        <div class="card-actions">
          <a href="#" class="btn-map" onclick="openMap(event, ${parking.latitude}, ${parking.longitude})">
            ğŸ—ºï¸ åœ°å›³
          </a>
          <a href="#" class="btn-details">
            ğŸ“‹ è©³ç´°
          </a>
        </div>
      </div>
    </div>
  `;
}
```

### 7.2 HTMLãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¸ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¿½åŠ 

```javascript
// generate-from-json-sources.js ã®HTMLãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆéƒ¨åˆ†

const htmlTemplate = `
<!DOCTYPE html>
<html lang="ja">
<head>
  <!-- æ—¢å­˜ã®headå†…å®¹ -->

  <!-- Supabase Client -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <!-- FingerprintJS -->
  <script src="https://cdn.jsdelivr.net/npm/@fingerprintjs/fingerprintjs@3/dist/fp.min.js"></script>

  <!-- ã„ã„ã­æ©Ÿèƒ½CSS -->
  <style>
    ${likeButtonStyles}
  </style>
</head>
<body>
  <!-- æ—¢å­˜ã®bodyå†…å®¹ -->

  <!-- ã„ã„ã­æ©Ÿèƒ½JavaScript -->
  <script>
    // Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆæœŸåŒ–
    const supabase = window.supabase.createClient(
      'YOUR_SUPABASE_URL',
      'YOUR_SUPABASE_ANON_KEY'
    );

    ${likeButtonScript}
  </script>
</body>
</html>
`;
```

---

## 8. ã¾ã¨ã‚

### âœ… ãƒ‡ã‚¶ã‚¤ãƒ³æ–¹é‡

1. **æ—¢å­˜ãƒ‡ã‚¶ã‚¤ãƒ³ã‚’å®Œå…¨ç¶­æŒ**
   - ã‚ªãƒ¬ãƒ³ã‚¸ã‚¹ãƒˆãƒ©ã‚¤ãƒ—
   - ãƒ™ãƒ¼ã‚¸ãƒ¥èƒŒæ™¯
   - ç•ªå·è¡¨ç¤º
   - åœ°å›³ãƒ»æ¤œç´¢ãƒœã‚¿ãƒ³

2. **ã„ã„ã­ãƒœã‚¿ãƒ³ã¯æœ€å°é™ã®è¿½åŠ **
   - ã‚«ãƒ¼ãƒ‰å³ä¸Šã«é…ç½®ï¼ˆæ¡ˆAæ¨å¥¨ï¼‰
   - ãƒãƒ¼ãƒˆã‚¢ã‚¤ã‚³ãƒ³ + æ•°å­—
   - ã‚¯ãƒªãƒƒã‚¯ã§ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³

3. **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ**
   - ãƒ¢ãƒã‚¤ãƒ«ã§ã‚‚è¦‹ã‚„ã™ã
   - ã‚¿ãƒƒãƒæ“ä½œã«æœ€é©åŒ–

### ğŸ“‹ å®Ÿè£…ã®æµã‚Œ

1. CSSã«ã„ã„ã­ãƒœã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ«è¿½åŠ 
2. HTMLã‚«ãƒ¼ãƒ‰ç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆä¿®æ­£
3. JavaScriptã„ã„ã­æ©Ÿèƒ½å®Ÿè£…
4. Supabaseãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€£æº
5. 808ç®‡æ‰€ã®åœ°åŸŸãƒšãƒ¼ã‚¸ã‚’å†ç”Ÿæˆ

ã“ã®è¨­è¨ˆã§å•é¡Œãªã‘ã‚Œã°ã€å®Ÿè£…ã‚’é–‹å§‹ã§ãã¾ã™ï¼
