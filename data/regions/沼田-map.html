<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>沼田 - 地図</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { height: 100%; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
    #map { width: 100%; height: 100%; }

    .custom-marker {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 3px solid white;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .custom-marker:hover {
      transform: scale(1.2);
      z-index: 1000;
    }

    /* コンビニロゴマーカー */
    .convenience-logo-marker {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      background: white;
      border: 2px solid #4caf50;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
      padding: 4px;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .convenience-logo-marker:hover {
      transform: scale(1.2);
      z-index: 1000;
    }

    .convenience-logo-marker img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    .marker-center { background: #d32f2f; }
    .marker-parking { background: #1976d2; }
    .marker-toilet { background: #795548; }
    .marker-onsen { background: #f8bbd0; }
    .marker-restaurant { background: #ff9800; }

    .leaflet-popup-content { min-width: 200px; }
    .popup-title { font-weight: bold; font-size: 14px; margin-bottom: 6px; }
    .popup-info { font-size: 12px; color: #666; }
  </style>
</head>
<body>
  <div id="map"></div>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    // 地図初期化
    const map = L.map('map').setView([36.669179069010454, 139.08414997284785], 15);

    // OpenStreetMap タイル
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '© OpenStreetMap contributors',
      maxZoom: 19
    }).addTo(map);

    // マーカーデータ
    const markers = [
    {
        "type": "center",
        "id": "area_center",
        "lat": 36.669179069010454,
        "lng": 139.08414997284785,
        "title": "沼田",
        "description": "周辺のおすすめ車中泊スポット",
        "color": "#d32f2f"
    },
    {
        "type": "parking",
        "id": "parking_0",
        "lat": 36.688152,
        "lng": 139.105524,
        "title": "道の駅川場田園プラザＰ６",
        "number": 1,
        "distance": "2846m",
        "walking": "徒歩約36分",
        "color": "#1976d2"
    },
    {
        "type": "toilet",
        "id": "toilet_0_0",
        "lat": 36.688042996529,
        "lng": 139.10772460067,
        "title": "「道の駅」川場田園プラザ公衆トイレ",
        "distance": "197m",
        "color": "#795548"
    },
    {
        "type": "onsen",
        "id": "onsen_0_0",
        "lat": 36.688728,
        "lng": 139.105286,
        "title": "かわば田園温泉 楽楽の湯",
        "distance": "0.1km",
        "color": "#f8bbd0"
    },
    {
        "type": "onsen",
        "id": "onsen_0_1",
        "lat": 36.690052,
        "lng": 139.106903,
        "title": "塩河原温泉 湯元本家 みやた館",
        "distance": "0.2km",
        "color": "#f8bbd0"
    },
    {
        "type": "onsen",
        "id": "onsen_0_2",
        "lat": 36.693447,
        "lng": 139.106812,
        "title": "ホテル田園プラザ",
        "distance": "0.6km",
        "color": "#f8bbd0"
    },
    {
        "type": "parking",
        "id": "parking_1",
        "lat": 36.687374,
        "lng": 139.103893,
        "title": "道の駅川場田園プラザＰ７",
        "number": 2,
        "distance": "2685m",
        "walking": "徒歩約34分",
        "color": "#1976d2"
    },
    {
        "type": "onsen",
        "id": "onsen_1_0",
        "lat": 36.688728,
        "lng": 139.105286,
        "title": "かわば田園温泉 楽楽の湯",
        "distance": "0.2km",
        "color": "#f8bbd0"
    },
    {
        "type": "onsen",
        "id": "onsen_1_1",
        "lat": 36.690052,
        "lng": 139.106903,
        "title": "塩河原温泉 湯元本家 みやた館",
        "distance": "0.4km",
        "color": "#f8bbd0"
    },
    {
        "type": "onsen",
        "id": "onsen_1_2",
        "lat": 36.693447,
        "lng": 139.106812,
        "title": "ホテル田園プラザ",
        "distance": "0.7km",
        "color": "#f8bbd0"
    },
    {
        "type": "parking",
        "id": "parking_2",
        "lat": 36.686583,
        "lng": 139.108185,
        "title": "道の駅　川場田園プラザＰ１",
        "number": 3,
        "distance": "2891m",
        "walking": "徒歩約37分",
        "color": "#1976d2"
    },
    {
        "type": "toilet",
        "id": "toilet_2_0",
        "lat": 36.688042996529,
        "lng": 139.10772460067,
        "title": "「道の駅」川場田園プラザ公衆トイレ",
        "distance": "168m",
        "color": "#795548"
    },
    {
        "type": "onsen",
        "id": "onsen_2_0",
        "lat": 36.688728,
        "lng": 139.105286,
        "title": "かわば田園温泉 楽楽の湯",
        "distance": "0.4km",
        "color": "#f8bbd0"
    },
    {
        "type": "onsen",
        "id": "onsen_2_1",
        "lat": 36.690052,
        "lng": 139.106903,
        "title": "塩河原温泉 湯元本家 みやた館",
        "distance": "0.4km",
        "color": "#f8bbd0"
    },
    {
        "type": "onsen",
        "id": "onsen_2_2",
        "lat": 36.684231,
        "lng": 139.114975,
        "title": "米山温泉旅館",
        "distance": "0.7km",
        "color": "#f8bbd0"
    },
    {
        "type": "parking",
        "id": "parking_3",
        "lat": 36.688066,
        "lng": 139.107924,
        "title": "道の駅　川場田園プラザＰ２",
        "number": 4,
        "distance": "2988m",
        "walking": "徒歩約38分",
        "color": "#1976d2"
    },
    {
        "type": "toilet",
        "id": "toilet_3_0",
        "lat": 36.688042996529,
        "lng": 139.10772460067,
        "title": "「道の駅」川場田園プラザ公衆トイレ",
        "distance": "18m",
        "color": "#795548"
    },
    {
        "type": "onsen",
        "id": "onsen_3_0",
        "lat": 36.690052,
        "lng": 139.106903,
        "title": "塩河原温泉 湯元本家 みやた館",
        "distance": "0.2km",
        "color": "#f8bbd0"
    },
    {
        "type": "onsen",
        "id": "onsen_3_1",
        "lat": 36.688728,
        "lng": 139.105286,
        "title": "かわば田園温泉 楽楽の湯",
        "distance": "0.2km",
        "color": "#f8bbd0"
    },
    {
        "type": "onsen",
        "id": "onsen_3_2",
        "lat": 36.693447,
        "lng": 139.106812,
        "title": "ホテル田園プラザ",
        "distance": "0.6km",
        "color": "#f8bbd0"
    },
    {
        "type": "parking",
        "id": "parking_4",
        "lat": 36.688199,
        "lng": 139.106874,
        "title": "道の駅　川場田園プラザＰ３",
        "number": 5,
        "distance": "2932m",
        "walking": "徒歩約37分",
        "color": "#1976d2"
    },
    {
        "type": "toilet",
        "id": "toilet_4_0",
        "lat": 36.688042996529,
        "lng": 139.10772460067,
        "title": "「道の駅」川場田園プラザ公衆トイレ",
        "distance": "78m",
        "color": "#795548"
    },
    {
        "type": "onsen",
        "id": "onsen_4_0",
        "lat": 36.688728,
        "lng": 139.105286,
        "title": "かわば田園温泉 楽楽の湯",
        "distance": "0.2km",
        "color": "#f8bbd0"
    },
    {
        "type": "onsen",
        "id": "onsen_4_1",
        "lat": 36.690052,
        "lng": 139.106903,
        "title": "塩河原温泉 湯元本家 みやた館",
        "distance": "0.2km",
        "color": "#f8bbd0"
    },
    {
        "type": "onsen",
        "id": "onsen_4_2",
        "lat": 36.693447,
        "lng": 139.106812,
        "title": "ホテル田園プラザ",
        "distance": "0.6km",
        "color": "#f8bbd0"
    },
    {
        "type": "parking",
        "id": "parking_5",
        "lat": 36.688716,
        "lng": 139.108724,
        "title": "道の駅　川場田園プラザＰ４",
        "number": 6,
        "distance": "3089m",
        "walking": "徒歩約39分",
        "color": "#1976d2"
    },
    {
        "type": "toilet",
        "id": "toilet_5_0",
        "lat": 36.688042996529,
        "lng": 139.10772460067,
        "title": "「道の駅」川場田園プラザ公衆トイレ",
        "distance": "116m",
        "color": "#795548"
    },
    {
        "type": "onsen",
        "id": "onsen_5_0",
        "lat": 36.690052,
        "lng": 139.106903,
        "title": "塩河原温泉 湯元本家 みやた館",
        "distance": "0.2km",
        "color": "#f8bbd0"
    },
    {
        "type": "onsen",
        "id": "onsen_5_1",
        "lat": 36.688728,
        "lng": 139.105286,
        "title": "かわば田園温泉 楽楽の湯",
        "distance": "0.3km",
        "color": "#f8bbd0"
    },
    {
        "type": "onsen",
        "id": "onsen_5_2",
        "lat": 36.693447,
        "lng": 139.106812,
        "title": "ホテル田園プラザ",
        "distance": "0.6km",
        "color": "#f8bbd0"
    },
    {
        "type": "parking",
        "id": "parking_6",
        "lat": 36.688716,
        "lng": 139.106485,
        "title": "道の駅　川場田園プラザＰ５",
        "number": 7,
        "distance": "2951m",
        "walking": "徒歩約37分",
        "color": "#1976d2"
    },
    {
        "type": "toilet",
        "id": "toilet_6_0",
        "lat": 36.688042996529,
        "lng": 139.10772460067,
        "title": "「道の駅」川場田園プラザ公衆トイレ",
        "distance": "134m",
        "color": "#795548"
    },
    {
        "type": "onsen",
        "id": "onsen_6_0",
        "lat": 36.688728,
        "lng": 139.105286,
        "title": "かわば田園温泉 楽楽の湯",
        "distance": "0.1km",
        "color": "#f8bbd0"
    },
    {
        "type": "onsen",
        "id": "onsen_6_1",
        "lat": 36.690052,
        "lng": 139.106903,
        "title": "塩河原温泉 湯元本家 みやた館",
        "distance": "0.2km",
        "color": "#f8bbd0"
    },
    {
        "type": "onsen",
        "id": "onsen_6_2",
        "lat": 36.693447,
        "lng": 139.106812,
        "title": "ホテル田園プラザ",
        "distance": "0.5km",
        "color": "#f8bbd0"
    },
    {
        "type": "parking",
        "id": "parking_7",
        "lat": 36.688149,
        "lng": 139.105335,
        "title": "道の駅　川場田園プラザＰ６",
        "number": 8,
        "distance": "2835m",
        "walking": "徒歩約36分",
        "color": "#1976d2"
    },
    {
        "type": "toilet",
        "id": "toilet_7_0",
        "lat": 36.688042996529,
        "lng": 139.10772460067,
        "title": "「道の駅」川場田園プラザ公衆トイレ",
        "distance": "214m",
        "color": "#795548"
    },
    {
        "type": "onsen",
        "id": "onsen_7_0",
        "lat": 36.688728,
        "lng": 139.105286,
        "title": "かわば田園温泉 楽楽の湯",
        "distance": "0.1km",
        "color": "#f8bbd0"
    },
    {
        "type": "onsen",
        "id": "onsen_7_1",
        "lat": 36.690052,
        "lng": 139.106903,
        "title": "塩河原温泉 湯元本家 みやた館",
        "distance": "0.3km",
        "color": "#f8bbd0"
    },
    {
        "type": "onsen",
        "id": "onsen_7_2",
        "lat": 36.693447,
        "lng": 139.106812,
        "title": "ホテル田園プラザ",
        "distance": "0.6km",
        "color": "#f8bbd0"
    },
    {
        "type": "parking",
        "id": "parking_8",
        "lat": 36.687433,
        "lng": 139.103696,
        "title": "道の駅　川場田園プラザＰ７",
        "number": 9,
        "distance": "2678m",
        "walking": "徒歩約34分",
        "color": "#1976d2"
    },
    {
        "type": "onsen",
        "id": "onsen_8_0",
        "lat": 36.688728,
        "lng": 139.105286,
        "title": "かわば田園温泉 楽楽の湯",
        "distance": "0.2km",
        "color": "#f8bbd0"
    },
    {
        "type": "onsen",
        "id": "onsen_8_1",
        "lat": 36.690052,
        "lng": 139.106903,
        "title": "塩河原温泉 湯元本家 みやた館",
        "distance": "0.4km",
        "color": "#f8bbd0"
    },
    {
        "type": "onsen",
        "id": "onsen_8_2",
        "lat": 36.693447,
        "lng": 139.106812,
        "title": "ホテル田園プラザ",
        "distance": "0.7km",
        "color": "#f8bbd0"
    },
    {
        "type": "parking",
        "id": "parking_9",
        "lat": 36.68618,
        "lng": 139.107957,
        "title": "道の駅川場田園プラザＰ１",
        "number": 10,
        "distance": "2846m",
        "walking": "徒歩約36分",
        "color": "#1976d2"
    },
    {
        "type": "toilet",
        "id": "toilet_9_0",
        "lat": 36.688042996529,
        "lng": 139.10772460067,
        "title": "「道の駅」川場田園プラザ公衆トイレ",
        "distance": "208m",
        "color": "#795548"
    },
    {
        "type": "onsen",
        "id": "onsen_9_0",
        "lat": 36.688728,
        "lng": 139.105286,
        "title": "かわば田園温泉 楽楽の湯",
        "distance": "0.4km",
        "color": "#f8bbd0"
    },
    {
        "type": "onsen",
        "id": "onsen_9_1",
        "lat": 36.690052,
        "lng": 139.106903,
        "title": "塩河原温泉 湯元本家 みやた館",
        "distance": "0.4km",
        "color": "#f8bbd0"
    },
    {
        "type": "onsen",
        "id": "onsen_9_2",
        "lat": 36.684231,
        "lng": 139.114975,
        "title": "米山温泉旅館",
        "distance": "0.7km",
        "color": "#f8bbd0"
    },
    {
        "type": "restaurant",
        "id": "restaurant_0",
        "lat": 36.702886723153775,
        "lng": 139.11207077843625,
        "title": "ヴェンティノーヴェ",
        "number": 1,
        "genre": "イタリアン",
        "address": "群馬県利根郡川場村谷地2593-1 土田酒造敷地",
        "color": "#ff9800"
    },
    {
        "type": "restaurant",
        "id": "restaurant_1",
        "lat": 36.65100127874096,
        "lng": 139.03925532576366,
        "title": "そば源",
        "number": 2,
        "genre": "そば",
        "address": "群馬県沼田市柳町字寺久保2710",
        "color": "#ff9800"
    },
    {
        "type": "restaurant",
        "id": "restaurant_2",
        "lat": 36.66243063707392,
        "lng": 139.09584189360376,
        "title": "あおぞら 沼田店",
        "number": 3,
        "genre": "焼肉",
        "address": "群馬県沼田市久屋原町1551",
        "color": "#ff9800"
    },
    {
        "type": "restaurant",
        "id": "restaurant_3",
        "lat": 36.66039763707316,
        "lng": 139.0894318935877,
        "title": "馬鹿旨",
        "number": 4,
        "genre": "中華料理",
        "address": "群馬県沼田市久屋原町25-1",
        "color": "#ff9800"
    }
];

    // マーカーオブジェクトを保存
    const markerObjects = {};

    // アイコン取得関数
    function getMarkerIcon(type, number) {
      if (type === 'parking' && number) {
        return number;
      }
      if (type === 'restaurant' && number) {
        return number;
      }
      const icons = {
        center: '📍',
        parking: '🅿️',
        toilet: '🚻',
        onsen: '♨️',
        restaurant: '🍴'
      };
      return icons[type] || '📌';
    }

    // マーカーを作成
    markers.forEach(markerData => {
      let icon;
      let zIndexOffset = 0;

      // z-indexの設定（駐車場を最前面に）
      if (markerData.type === 'parking') {
        zIndexOffset = 1000;
      } else if (markerData.type === 'center') {
        zIndexOffset = 900;
      } else if (markerData.type === 'restaurant') {
        zIndexOffset = 800;
      } else if (markerData.type === 'convenience') {
        zIndexOffset = 700;
      } else if (markerData.type === 'toilet') {
        zIndexOffset = 600;
      } else if (markerData.type === 'onsen') {
        zIndexOffset = 500;
      }

      // コンビニの場合はロゴ画像を使用（Base64埋め込み）
      if (markerData.type === 'convenience' && markerData.logo) {
        icon = L.divIcon({
          className: 'custom-icon',
          html: `<div class="convenience-logo-marker"><img src="${markerData.logo}" alt="${markerData.subType}"></div>`,
          iconSize: [40, 40],
          iconAnchor: [20, 20]
        });
      } else {
        // その他のマーカーは従来通り
        icon = L.divIcon({
          className: 'custom-icon',
          html: `<div class="custom-marker marker-${markerData.type}" style="background-color: ${markerData.color}">${getMarkerIcon(markerData.type, markerData.number)}</div>`,
          iconSize: [40, 40],
          iconAnchor: [20, 20]
        });
      }

      // マーカー作成（zIndexOffsetを指定）
      const marker = L.marker([markerData.lat, markerData.lng], {
        icon: icon,
        zIndexOffset: zIndexOffset
      }).addTo(map);

      // ポップアップ内容
      let popupContent = `<div class="popup-title">${markerData.title}</div>`;

      if (markerData.subType) {
        popupContent += `<div class="popup-info">🏪 ${markerData.subType}</div>`;
      }
      if (markerData.description) {
        popupContent += `<div class="popup-info">${markerData.description}</div>`;
      }
      if (markerData.distance) {
        popupContent += `<div class="popup-info">📍 ${markerData.distance}</div>`;
      }
      if (markerData.walking) {
        popupContent += `<div class="popup-info">🚶 ${markerData.walking}</div>`;
      }
      if (markerData.genre) {
        popupContent += `<div class="popup-info">🍽️ ${markerData.genre}</div>`;
      }
      if (markerData.address) {
        popupContent += `<div class="popup-info" style="margin-top: 4px;">${markerData.address}</div>`;
      }

      marker.bindPopup(popupContent);

      // マーカーオブジェクトを保存
      markerObjects[markerData.id] = marker;
    });

    // 外部から呼び出せる関数
    window.showMarker = function(markerId) {
      const marker = markerObjects[markerId];
      if (marker) {
        // アニメーションで地図を移動
        map.setView(marker.getLatLng(), 17, {
          animate: true,
          duration: 0.5
        });
        marker.openPopup();
      }
    };
  </script>
</body>
</html>